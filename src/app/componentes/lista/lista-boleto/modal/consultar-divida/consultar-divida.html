<br /><br />

<mat-dialog-content class="cd-content">
  <div class="row topo">
    <div class="col-2">
      <img
        src="https://www.gov.br/incra/pt-br/canais_atendimento/LogoINCRAverticaldegrad.png"
        class="logo"
      />
    </div>
    <div class="col-10 texto">
      <strong>
        <h5>INCRA - Instituto Nacional de Colonização e Reforma Agrária</h5>
      </strong>
      <br />
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
      tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
      veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
      commodo consequat.
    </div>
  </div>

  <!-- Cabeçalho com identificação do beneficiário -->
  <div class="header-dados">
    <div><strong>DEVEDOR:</strong> {{ beneficiarioNome || "xxxxx" }}</div>
    <div><strong>CPF:</strong> {{ beneficiarioCpf || "xxxxx" }}</div>
  </div>

  <!-- DADOS DO DÉBITO SELECIONADO -->

  <div class="table-container">
    <!-- BLOCO 6 – IDENTIFICAÇÃO DA RECEITA -->
    <h3 class="bloco-titulo">Identificação da Receita</h3>
    <table class="pagamentos-table" role="table">
      <thead>
        <tr>
          <th>Tipo da Receita</th>
          <th>Descrição da Receita</th>
          <th>Valor Original</th>
          <th>Nº Prestações</th>
          <th>Saldo Devedor</th>
          <!--<th>Objeto da cobrança</th>-->
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <!-- Campo vazio quando não há seleção, preenchido quando há seleção -->
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? debitoSelecionado.tipoReceita || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? debitoSelecionado.descricaoReceita || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? formataNumero(debitoSelecionado.valorOriginal)
                  : ''
              "
              [disabled]="!modoEdicao"
              style="text-align: right"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? (debitoSelecionado.numeroPrestacoes ?? 'xxxxx')
                  : ''
              "
              [disabled]="!modoEdicao"
              style="text-align: right"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? formataNumero(debitoSelecionado.saldoDevedor)
                  : ''
              "
              [disabled]="!modoEdicao"
              style="text-align: right"
            />
          </td>
          <!--<td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? debitoSelecionado.objetoCredito || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
            />
          </td>-->
        </tr>
      </tbody>
    </table>

    <!-- BLOCO 3 – PLANO DE PAGAMENTO -->
    <h3 class="bloco-titulo">Plano de pagamento</h3>

    <table class="pagamentos-table" role="table">
      <thead>
        <tr>
          <th>Número de referência</th>
          <th>Nosso número</th>
          <th>Número ref. antigo</th>
          <th>Prestação</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? debitoSelecionado.numeroReferencia || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? debitoSelecionado.nossoNumero || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? debitoSelecionado.numeroRefAntigo || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado ? debitoSelecionado.prestacao || 'xxxxx' : ''
              "
              [disabled]="!modoEdicao"
            />
          </td>
        </tr>
      </tbody>
    </table>

    <table class="pagamentos-table" role="table">
      <thead>
        <tr>
          <th>Vencimento original</th>
          <th>Data para pagamento</th>
          <th>Valor principal</th>
          <th>Correção</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? debitoSelecionado.vencimentoOriginal || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? debitoSelecionado.dataParaPagamento || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? formataNumero(debitoSelecionado.valorPrincipal) || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
              style="text-align: right"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? formataNumero(debitoSelecionado.correcao) || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
              style="text-align: right"
            />
          </td>
        </tr>
      </tbody>
    </table>

    <table class="pagamentos-table" role="table">
      <thead>
        <tr>
          <th>Índice</th>
          <th>mês/ano</th>
          <th>coeficiente</th>
          <th>Valor corrigido</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado ? debitoSelecionado.indice || 'xxxxx' : ''
              "
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado ? debitoSelecionado.mesAno || 'xxxxx' : ''
              "
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? formataNumero(debitoSelecionado.coeficiente) || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
              style="text-align: right"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? formataNumero(debitoSelecionado.valorCorrigido) || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
              style="text-align: right"
            />
          </td>
        </tr>
      </tbody>
    </table>

    <table class="pagamentos-table" role="table">
      <thead>
        <tr>
          <th>Multa</th>
          <th>Juros de mora</th>
          <th>Valor com encargos</th>
          <th>Valor total prestação</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? formataNumero(debitoSelecionado.multa) || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
              style="text-align: right"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? formataNumero(debitoSelecionado.jurosMora) || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
              style="text-align: right"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? formataNumero(debitoSelecionado.valorComEncargos) || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
              style="text-align: right"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? formataNumero(debitoSelecionado.valorTotalPrestacao) ||
                    'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
              style="text-align: right"
            />
          </td>
        </tr>
      </tbody>
    </table>

    <table class="pagamentos-table" role="table">
      <thead>
        <tr>
          <th>Data entrega GRU</th>
          <th>Forma entrega GRU</th>
          <th>Motivo não entrega GRU</th>
          <th>Observação</th>
          <th>N. Req. SEI</th>
          <th>Data Req. SEI</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? debitoSelecionado.dataEntregaGRU || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? debitoSelecionado.formaEntregaGRU || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="
                debitoSelecionado
                  ? debitoSelecionado.motivoNaoEntregaGRU || 'xxxxx'
                  : ''
              "
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              value="
                Observações aqui
              "
              [disabled]="!modoEdicao"
            />
          </td>

          <td>
            <input
              type="text"
              value="
                1111111111111
              "
              [disabled]="!modoEdicao"
            />
          </td>

          <td>
            <input
              type="text"
              value="
                15/12/2010
              "
              [disabled]="!modoEdicao"
            />
          </td>
        </tr>
      </tbody>
    </table>

    <div style="height: 1rem"></div>
    <hr />
    <div style="height: 1rem"></div>
  </div>
  <!-- Editar e aproveitamento de credito -->
  <div class="acoes">
    <button
      mat-flat-button
      color="accent"
      class="btn-baixar"
      (click)="editar()"
      [disabled]="!exatamenteUmaSelecao || modoEdicao"
    >
      <mat-icon>edit</mat-icon>
      Editar
    </button>

    <button mat-flat-button color="accent" class="btn-baixar">
      <mat-icon>account_balance_wallet</mat-icon>
      Aproveitamento de crédito
    </button>
  </div>

  <!-- Indicador quando não há débito selecionado -->
  <div *ngIf="!debitoSelecionado" class="nenhum-selecionado">
    <p>
      <mat-icon>info</mat-icon> Selecione uma linha na tabela abaixo para
      visualizar os detalhes do débito nos campos acima.
    </p>
  </div>

  <!-- DADOS DO DÉBITO SELECIONADO -->
  <div class="table-container">
    <!-- ... resto do código das tabelas ... -->
  </div>

  <!-- GRID DE PARCELAS / LANÇAMENTOS 
  <h3 class="bloco-titulo">Parcelas / Lançamentos</h3>-->

  <div class="table-container mat-elevation-z1">
    <table mat-table [dataSource]="debitos" class="pagamentos-table">
      <!-- SELEÇÃO -->
      <ng-container matColumnDef="select">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let row">
          <mat-checkbox
            (change)="selecionarLinha(row)"
            [checked]="selection.isSelected(row)"
            (click)="$event.stopPropagation()"
          >
          </mat-checkbox>
        </td>
      </ng-container>

      <!-- NÚMERO DE REFERÊNCIA -->
      <ng-container matColumnDef="numeroReferencia">
        <th mat-header-cell *matHeaderCellDef>Nº Ref.</th>
        <td mat-cell *matCellDef="let d">
          {{ d.numeroReferencia || "—" }}
        </td>
      </ng-container>

      <!-- NOSSO NÚMERO -->
      <ng-container matColumnDef="nossoNumero">
        <th mat-header-cell *matHeaderCellDef>Nosso Número</th>
        <td mat-cell *matCellDef="let d">
          {{ d.nossoNumero || "—" }}
        </td>
      </ng-container>

      <!-- PARCELA -->
      <ng-container matColumnDef="parcela">
        <th mat-header-cell *matHeaderCellDef>Prest.</th>
        <td mat-cell *matCellDef="let d" style="text-align: right">
          {{ d.prestacao || "—" }}
        </td>
      </ng-container>

      <!-- DATA DE VENCIMENTO -->
      <ng-container matColumnDef="dataVencimento">
        <th mat-header-cell *matHeaderCellDef>Vencimento</th>
        <td mat-cell *matCellDef="let d">
          {{ d.vencimentoOriginal || "—" }}
        </td>
      </ng-container>

      <!-- PRORROGAÇÃO -->
      <ng-container matColumnDef="prorrogacao">
        <th mat-header-cell *matHeaderCellDef>Prorrogação</th>
        <td mat-cell *matCellDef="let d">
          {{ d.dataParaPagamento || "—" }}
        </td>
      </ng-container>

      <!-- MOEDA -->
      <ng-container matColumnDef="moeda">
        <th mat-header-cell *matHeaderCellDef>Moeda</th>
        <td mat-cell *matCellDef="let d">
          {{ d.moeda || "—" }}
        </td>
      </ng-container>

      <!-- VALOR ORIGINAL -->
      <ng-container matColumnDef="valorOriginal">
        <th mat-header-cell *matHeaderCellDef>Valor</th>
        <td mat-cell *matCellDef="let d" style="text-align: right">
          {{ formataNumero(d.valorOriginal) }}
        </td>
      </ng-container>

      <!-- CORREÇÃO -->
      <ng-container matColumnDef="correcao">
        <th mat-header-cell *matHeaderCellDef>Correção</th>
        <td mat-cell *matCellDef="let d" style="text-align: right">
          {{ formataNumero(d.correcao) }}
        </td>
      </ng-container>

      <!-- JUROS -->
      <ng-container matColumnDef="juros">
        <th mat-header-cell *matHeaderCellDef>Juros</th>
        <td mat-cell *matCellDef="let d" style="text-align: right">
          {{ formataNumero(d.juros) }}
        </td>
      </ng-container>

      <!-- JUROS MORA -->
      <ng-container matColumnDef="jurosMora">
        <th mat-header-cell *matHeaderCellDef>Juros Mora</th>
        <td mat-cell *matCellDef="let d" style="text-align: right">
          {{ formataNumero(d.jurosMora) }}
        </td>
      </ng-container>

      <!-- MULTA -->
      <ng-container matColumnDef="multa">
        <th mat-header-cell *matHeaderCellDef>Multa</th>
        <td mat-cell *matCellDef="let d" style="text-align: right">
          {{ formataNumero(d.multa) }}
        </td>
      </ng-container>

      <!-- DESCONTO -->
      <ng-container matColumnDef="desconto">
        <th mat-header-cell *matHeaderCellDef>Descontos</th>
        <td mat-cell *matCellDef="let d" style="text-align: right">
          {{ formataNumero(d.desconto) }}
        </td>
      </ng-container>

      <!-- REMISSÃO -->
      <ng-container matColumnDef="remissao">
        <th mat-header-cell *matHeaderCellDef>Desc. Exced.</th>
        <td mat-cell *matCellDef="let d" style="text-align: right">
          {{ formataNumero(d.remissao) }}
        </td>
      </ng-container>

      <!-- CRÉDITO -->
      <ng-container matColumnDef="credito">
        <th mat-header-cell *matHeaderCellDef>Crédito</th>
        <td mat-cell *matCellDef="let d" style="text-align: right">
          {{ formataNumero(d.credito) }}
        </td>
      </ng-container>

      <!-- VALOR DEVIDO -->
      <ng-container matColumnDef="valorDevido">
        <th mat-header-cell *matHeaderCellDef>A pagar</th>
        <td mat-cell *matCellDef="let d" style="text-align: right">
          {{ formataNumero(d.valorDevido) }}
        </td>
      </ng-container>

      <!-- MOEDA FINAL -->
      <ng-container matColumnDef="moedaFinal">
        <th mat-header-cell *matHeaderCellDef>Moeda</th>
        <td mat-cell *matCellDef="let d">
          {{ d.moedaFinal || "—" }}
        </td>
      </ng-container>

      <!-- BAIXADO -->
      <ng-container matColumnDef="baixado">
        <th mat-header-cell *matHeaderCellDef>Baixado</th>
        <td mat-cell *matCellDef="let d">
          {{ d.baixado || "—" }}
        </td>
      </ng-container>

      <!-- NÚMERO AVISO BAIXA -->
      <ng-container matColumnDef="numeroAvisoBaixa">
        <th mat-header-cell *matHeaderCellDef>Nº Aviso Baixa</th>
        <td mat-cell *matCellDef="let d">
          {{ d.numeroAvisoBaixa || "—" }}
        </td>
      </ng-container>

      <!-- TIPO DE BAIXA -->
      <ng-container matColumnDef="tipoBaixa">
        <th mat-header-cell *matHeaderCellDef>Tipo de Baixa</th>
        <td mat-cell *matCellDef="let d">
          {{ d.tipoBaixa || "—" }}
        </td>
      </ng-container>

      <!-- PRESTAÇÃO ÚNICA -->
      <ng-container matColumnDef="prestacaoUnica">
        <th mat-header-cell *matHeaderCellDef>Prestação Única</th>
        <td mat-cell *matCellDef="let d">
          {{ d.prestacaoUnica || "—" }}
        </td>
      </ng-container>

      <!-- DATA BAIXA -->
      <ng-container matColumnDef="dataBaixa">
        <th mat-header-cell *matHeaderCellDef>Data Baixa</th>
        <td mat-cell *matCellDef="let d">
          {{ d.dataBaixa || "—" }}
        </td>
      </ng-container>

      <!-- TOTAL A PAGAR -->
      <ng-container matColumnDef="totalPagar">
        <th mat-header-cell *matHeaderCellDef>Total a pagar</th>
        <td mat-cell *matCellDef="let d" style="text-align: right">
          {{ formataNumero(d.valorTotalPrestacao) }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <!--<tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>-->
      <tr
        mat-row
        *matRowDef="let row; columns: displayedColumns"
        (click)="selecionarLinha(row)"
      ></tr>
    </table>
  </div>
</mat-dialog-content>

<!-- AÇÕES -->
<div class="acoes">
  <button
    mat-flat-button
    color="primary"
    (click)="editar()"
    [disabled]="modoEdicao || !possuiSelecao"
  >
    <mat-icon>receipt_long</mat-icon>
    Emitir GRU
  </button>

  <button
    mat-flat-button
    color="accent"
    (click)="baixarSituacaoSelecionados()"
    [disabled]="modoEdicao || !possuiSelecao"
  >
    <mat-icon>check_circle</mat-icon>
    Dar Baixa
  </button>

  <button
    mat-flat-button
    color="primary"
    (click)="agruparPrestacoesSelecionadas()"
    [disabled]="modoEdicao || !possuiSelecao"
  >
    <mat-icon>merge</mat-icon>
    Agrupar prestações
  </button>
  <!--
  <button mat-flat-button color="accent" class="btn-baixar">
    <mat-icon>payments</mat-icon>
    Solicitar pagamento à vista
  </button>-->

  <button mat-flat-button color="accent" class="btn-baixar">
    <mat-icon>add_circle</mat-icon>
    Incluir
  </button>

  <button
    mat-flat-button
    color="accent"
    class="btn-baixar"
    mat-flat-button
    color="primary"
    [disabled]="modoEdicao || !possuiSelecao"
  >
    <mat-icon>delete</mat-icon>
    Excluir
  </button>
</div>
<div class="acoes">
  <button
    mat-flat-button
    color="accent"
    class="btn-baixar"
    (click)="imprimir()"
    [disabled]="!possuiSelecao"
  >
    <mat-icon>print</mat-icon>
    Imprimir
  </button>

  <button
    mat-flat-button
    color="accent"
    class="btn-baixar"
    (click)="salvar()"
    [disabled]="!modoEdicao"
  >
    <mat-icon>save</mat-icon>
    Salvar alterações
  </button>

  <mat-dialog-actions align="end">
    <button mat-stroked-button (click)="fechar()" class="btn-fechar">
      <mat-icon>close</mat-icon>
      Fechar
    </button>
  </mat-dialog-actions>
</div>
