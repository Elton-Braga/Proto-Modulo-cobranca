<br /><br />

<mat-dialog-content class="cd-content">
  <div class="row topo">
    <div class="col-2">
      <img
        src="https://www.gov.br/incra/pt-br/canais_atendimento/LogoINCRAverticaldegrad.png"
        class="logo"
      />
    </div>
    <div class="col-10 texto">
      <strong>
        <h5>INCRA - Instituto Nacional de Colonização e Reforma Agrária</h5>
      </strong>
      <br />
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
      tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim
      veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea
      commodo consequat.
    </div>
  </div>

  <!-- Cabeçalho com identificação do beneficiário -->
  <div class="header-dados">
    <div><strong>DEVEDOR:</strong> {{ beneficiarioNome || "xxxxx" }}</div>
    <div><strong>CPF:</strong> {{ beneficiarioCpf || "xxxxx" }}</div>
  </div>

  <!-- DADOS DO DÉBITO SELECIONADO -->
  <div class="table-container" *ngIf="debitoSelecionado; else vazio">
    <!-- BLOCO 6 – IDENTIFICAÇÃO DA RECEITA -->
    <h3 class="bloco-titulo">Identificação da Receita</h3>
    <table class="pagamentos-table" role="table">
      <thead>
        <tr>
          <th>Tipo da Receita</th>
          <th>Descrição da Receita</th>
          <th>Valor Original</th>
          <th>Nº Prestações</th>
          <th>Saldo Devedor</th>
          <th>Objeto do Crédito</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <input
              type="text"
              [value]="debitoSelecionado.tipoReceita || 'xxxxx'"
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="debitoSelecionado.descricaoReceita || 'xxxxx'"
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="formataNumero(debitoSelecionado.valorOriginal)"
              [disabled]="!modoEdicao"
              style="text-align: right"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="debitoSelecionado.numeroPrestacoes ?? 'xxxxx'"
              [disabled]="!modoEdicao"
              style="text-align: right"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="formataNumero(debitoSelecionado.saldoDevedor)"
              [disabled]="!modoEdicao"
              style="text-align: right"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="debitoSelecionado.objetoCredito || 'xxxxx'"
              [disabled]="!modoEdicao"
            />
          </td>
        </tr>
      </tbody>
    </table>

    <!-- BLOCO 3 – PLANO DE PAGAMENTO -->
    <h3 class="bloco-titulo">Plano de pagamento</h3>
    <table class="pagamentos-table" role="table">
      <thead>
        <tr>
          <th>Tipo da Receita</th>
          <th>Valor Concedido</th>
          <th>Prazos / Condições</th>
          <th>Regras Legais</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <input
              type="text"
              [value]="debitoSelecionado.tipoReceita || 'xxxxx'"
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="formataNumero(debitoSelecionado.valorConcedido)"
              [disabled]="!modoEdicao"
              style="text-align: right"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="debitoSelecionado.prazosCondicoesReembolso || 'xxxxx'"
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="debitoSelecionado.regrasLegaisPrograma || 'xxxxx'"
              [disabled]="!modoEdicao"
            />
          </td>
        </tr>
      </tbody>
    </table>

    <!-- BLOCO 4 – DOCUMENTO DE TITULAÇÃO -->
    <table class="pagamentos-table" role="table">
      <thead>
        <tr>
          <th>Título de Domínio</th>
          <th>Contrato</th>
          <th>Termo Aditivo</th>
          <th>Outros Documentos</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <input
              type="text"
              [value]="debitoSelecionado.tituloDominio || 'xxxxx'"
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="debitoSelecionado.contrato || 'xxxxx'"
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="debitoSelecionado.termoAditivo || 'xxxxx'"
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <ng-container
              *ngIf="debitoSelecionado.outrosDocumentos?.length; else semDocs"
            >
              <div
                *ngFor="let od of debitoSelecionado.outrosDocumentos"
                style="margin-bottom: 4px"
              >
                <input type="text" [value]="od" [disabled]="!modoEdicao" />
              </div>
            </ng-container>
            <ng-template #semDocs>
              <input type="text" value="xxxxx" disabled />
            </ng-template>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- BLOCO 5 – RECEITAS DIVERSAS -->
    <table class="pagamentos-table" role="table">
      <thead>
        <tr>
          <th>Descrição do Objeto</th>
          <th>Condições de Cobrança</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <input
              type="text"
              [value]="debitoSelecionado.descricaoObjeto || 'xxxxx'"
              [disabled]="!modoEdicao"
            />
          </td>
          <td>
            <input
              type="text"
              [value]="debitoSelecionado.condicoesCobranca || 'xxxxx'"
              [disabled]="!modoEdicao"
            />
          </td>
        </tr>
      </tbody>
    </table>

    <div style="height: 1rem"></div>
    <hr />
    <div style="height: 1rem"></div>
  </div>

  <!-- GRID DE PARCELAS / LANÇAMENTOS -->
  <h3 class="bloco-titulo">Parcelas / Lançamentos</h3>

  <div class="table-container mat-elevation-z1">
    <table mat-table [dataSource]="debitos" class="pagamentos-table">
      <!-- SELEÇÃO -->
      <ng-container matColumnDef="select">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let row">
          <mat-checkbox
            (click)="$event.stopPropagation()"
            (change)="selection.toggle(row)"
            [checked]="selection.isSelected(row)"
          >
          </mat-checkbox>
        </td>
      </ng-container>

      <!-- TIPO DA RECEITA -->
      <ng-container matColumnDef="tipoReceita">
        <th mat-header-cell *matHeaderCellDef>Tipo da Receita</th>
        <td mat-cell *matCellDef="let d">
          {{ d.tipoReceita || "—" }}
        </td>
      </ng-container>

      <!-- DESCRIÇÃO -->
      <ng-container matColumnDef="descricaoReceita">
        <th mat-header-cell *matHeaderCellDef>Descrição</th>
        <td mat-cell *matCellDef="let d">
          {{ d.descricaoReceita || "—" }}
        </td>
      </ng-container>

      <!-- VALOR ORIGINAL -->
      <ng-container matColumnDef="valorOriginal">
        <th mat-header-cell *matHeaderCellDef>Valor Original</th>
        <td mat-cell *matCellDef="let d" style="text-align: right">
          {{ formataNumero(d.valorOriginal) }}
        </td>
      </ng-container>

      <!-- Nº PRESTAÇÕES -->
      <ng-container matColumnDef="numeroPrestacoes">
        <th mat-header-cell *matHeaderCellDef>Nº Prestações</th>
        <td mat-cell *matCellDef="let d" style="text-align: right">
          {{ d.numeroPrestacoes || "—" }}
        </td>
      </ng-container>

      <!-- SALDO DEVEDOR -->
      <ng-container matColumnDef="saldoDevedor">
        <th mat-header-cell *matHeaderCellDef>Saldo Devedor</th>
        <td mat-cell *matCellDef="let d" style="text-align: right">
          {{ formataNumero(d.saldoDevedor) }}
        </td>
      </ng-container>

      <!-- OBJETO DO CRÉDITO -->
      <ng-container matColumnDef="objetoCredito">
        <th mat-header-cell *matHeaderCellDef>Objeto do Crédito</th>
        <td mat-cell *matCellDef="let d">
          {{ d.objetoCredito || "—" }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>

  <ng-template #vazio>
    <div class="vazio">Nenhum registro de débito encontrado.</div>
  </ng-template>
</mat-dialog-content>

<!-- AÇÕES -->
<div class="acoes">
  <button
    mat-flat-button
    color="primary"
    (click)="editar()"
    [disabled]="modoEdicao || !debitoSelecionado"
  >
    <mat-icon>edit</mat-icon>
    Editar
  </button>

  <button
    mat-flat-button
    color="accent"
    (click)="salvar()"
    [disabled]="!modoEdicao"
  >
    <mat-icon>save</mat-icon>
    Salvar
  </button>

  <button
    mat-flat-button
    color="primary"
    (click)="imprimir()"
    class="btn-imprimir"
  >
    <mat-icon>print</mat-icon>
    Imprimir
  </button>

  <button
    mat-flat-button
    color="accent"
    (click)="baixarGRU()"
    class="btn-baixar"
  >
    <mat-icon>download</mat-icon>
    Baixar GRU
  </button>

  <mat-dialog-actions align="end">
    <button mat-stroked-button (click)="fechar()" class="btn-fechar">
      <mat-icon>close</mat-icon>
      Fechar
    </button>
  </mat-dialog-actions>
</div>
