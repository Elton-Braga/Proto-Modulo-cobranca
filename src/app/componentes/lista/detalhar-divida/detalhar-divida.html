<div class="modal-fullscreen">
  <br />
  <mat-dialog-content class="modal-content">
    <form [formGroup]="form">
      <mat-accordion multi="true">
        <!-- ================= TITULAR ================= -->
        <mat-expansion-panel expanded>
          <mat-expansion-panel-header>
            <mat-panel-title> Titular </mat-panel-title>
          </mat-expansion-panel-header>
          <div formGroupName="titular" class="container">
            <div class="row">
              <div
                class="col-md-3"
                *ngFor="let campo of getControles('titular')"
              >
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>{{ campo.key | titlecase }}</mat-label>
                  <input
                    matInput
                    [formControlName]="campo.key"
                    [type]="campo.key.includes('data') ? 'date' : 'text'"
                  />
                </mat-form-field>
              </div>
            </div>
          </div>
        </mat-expansion-panel>

        <!-- ================= CÔNJUGE ================= -->
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title> Cônjuge </mat-panel-title>
          </mat-expansion-panel-header>
          <div formGroupName="conjuge" class="container">
            <div class="row">
              <div
                class="col-md-3"
                *ngFor="let campo of getControles('conjuge')"
              >
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>{{ campo.key | titlecase }}</mat-label>
                  <input
                    matInput
                    [formControlName]="campo.key"
                    [type]="campo.key.includes('data') ? 'date' : 'text'"
                  />
                </mat-form-field>
              </div>
            </div>
          </div>
        </mat-expansion-panel>

        <!-- ================= Unidade Familiar ================= -->
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title> Unidade Familiar </mat-panel-title>
          </mat-expansion-panel-header>
          <div formGroupName="unidadeFamiliar" class="container">
            <div class="row">
              <div
                class="col-md-3"
                *ngFor="let campo of getControles('unidadeFamiliar')"
              >
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>{{ campo.key | titlecase }}</mat-label>
                  <input
                    matInput
                    [formControlName]="campo.key"
                    [type]="campo.key.includes('data') ? 'date' : 'text'"
                  />
                </mat-form-field>
              </div>
            </div>
          </div>
        </mat-expansion-panel>

        <!-- ================= PROJETO ASSENTAMENTO ================= -->
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title> Imóvel / Gleba / PA </mat-panel-title>
          </mat-expansion-panel-header>
          <div formGroupName="projetoAssentamento" class="container">
            <div class="row">
              <div
                class="col-md-3"
                *ngFor="let campo of getControles('projetoAssentamento')"
              >
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>{{ campo.key | titlecase }}</mat-label>
                  <input matInput [formControlName]="campo.key" />
                </mat-form-field>
              </div>
            </div>
          </div>
        </mat-expansion-panel>

        <!-- ================= Bloqueio ================= -->
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>Bloqueio / Desbloqueio</mat-panel-title>
          </mat-expansion-panel-header>

          <div formGroupName="bloqueio" class="container">
            <div class="row">
              <div
                class="col-md-3"
                *ngFor="let campo of getControles('bloqueio')"
              >
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>
                    {{ labelsBloqueio[campo.key] }}
                  </mat-label>

                  <ng-container
                    *ngIf="campo.key !== 'observacaoBloqueio'; else textareaObs"
                  >
                    <input matInput [formControlName]="campo.key" />
                  </ng-container>

                  <ng-template #textareaObs>
                    <textarea
                      matInput
                      rows="3"
                      [formControlName]="campo.key"
                    ></textarea>
                  </ng-template>
                </mat-form-field>
              </div>
            </div>
          </div>
        </mat-expansion-panel>

        <!-- ================= GEOLOCALIZAÇÃO ================= -->
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>Geolocalização</mat-panel-title>
          </mat-expansion-panel-header>

          <div formGroupName="geolocalizacao" class="container">
            <div class="row">
              <div
                class="col-md-3"
                *ngFor="let campo of getControles('geolocalizacao')"
              >
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>
                    {{ labelsGeolocalizacao[campo.key] }}
                  </mat-label>

                  <ng-container
                    *ngIf="campo.key !== 'observacoes'; else textareaGeo"
                  >
                    <input matInput [formControlName]="campo.key" />
                  </ng-container>

                  <ng-template #textareaGeo>
                    <textarea
                      matInput
                      rows="3"
                      [formControlName]="campo.key"
                    ></textarea>
                  </ng-template>
                </mat-form-field>
              </div>
            </div>
          </div>
        </mat-expansion-panel>

        <!-- ================= titulação ================= -->
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title> Titulação </mat-panel-title>
          </mat-expansion-panel-header>

          <div>
            <div>
              <div formGroupName="titulacao">
                <div class="row">
                  <div
                    class="col-md-3"
                    *ngFor="let campo of getControles('titulacao')"
                  >
                    <mat-form-field appearance="outline" class="w-100">
                      <mat-label>{{ campo.key | titlecase }}</mat-label>
                      <input matInput [formControlName]="campo.key" />
                    </mat-form-field>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </mat-expansion-panel>

        <!-- ================= ENDEREÇO E IMPEDIMENTO ================= -->
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>Endereço de Cobrança</mat-panel-title>
          </mat-expansion-panel-header>

          <div class="container">
            <div class="row">
              <!-- ENDEREÇO -->
              <div formGroupName="enderecoCobranca" class="col-md-8">
                <div class="row">
                  <div
                    class="col-md-6"
                    *ngFor="let campo of getControles('enderecoCobranca')"
                  >
                    <mat-form-field appearance="outline" class="w-100">
                      <mat-label>
                        {{ labelsEnderecoCobranca[campo.key] }}
                      </mat-label>

                      <input matInput [formControlName]="campo.key" />
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <!-- OUTRAS SEÇÕES FUTURAS -->
            </div>
          </div>
        </mat-expansion-panel>

        <!--OBSERVACAO-->

        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title> Observação </mat-panel-title>
          </mat-expansion-panel-header>

          <div>
            <div>
              <div formGroupName="observacao">
                <div>
                  <div *ngFor="let campo of getControles('observacao')">
                    <mat-form-field appearance="outline">
                      <mat-label>{{ campo.key | titlecase }}</mat-label>
                      <input matInput [formControlName]="campo.key" />
                    </mat-form-field>
                  </div>
                </div>
              </div>

              <!-- IMPEDIMENTO -->
            </div>
          </div>
        </mat-expansion-panel>
      </mat-accordion>
    </form>
  </mat-dialog-content>

  <!-- ================= RODAPÉ ================= -->
  <mat-dialog-actions class="modal-actions">
    <div class="actions-container">
      <div class="left-actions">
        <button
          mat-flat-button
          color="primary"
          (click)="abrirConsultarDivida(form.value)"
        >
          <mat-icon>search</mat-icon>
          Consultar Dívida
        </button>
      </div>

      <div class="right-actions">
        <!-- Botão Editar desabilita quando em edição -->
        <button
          mat-flat-button
          color="primary"
          (click)="habilitarEdicao()"
          [disabled]="editando"
        >
          <mat-icon>edit</mat-icon>
          Editar
        </button>

        <!-- Botão Salvar habilita apenas quando em edição -->
        <button
          mat-flat-button
          color="accent"
          (click)="salvar()"
          [disabled]="!editando"
        >
          <mat-icon>save</mat-icon>
          Salvar
        </button>

        <button mat-stroked-button color="warn" mat-dialog-close>
          <mat-icon>close</mat-icon>
          Fechar
        </button>
      </div>
    </div>
  </mat-dialog-actions>
</div>
